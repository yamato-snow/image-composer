# 画像合成自動化ツール (Image Composition Tool)

Next.jsを使用した商品画像の自動合成ツールです。テンプレートに基づいて商品情報CSVと画像を組み合わせ、一括処理することができます。

## 概要

このアプリケーションは、商品画像とテキスト情報を自動的に組み合わせて統一的なデザインの画像を大量生成するためのツールです。クライアントサイドで完結する設計となっており、データベースや認証機能はありません。AWS Amplifyでのデプロイを前提としています。

### 主な機能

- **テンプレート管理**
  - テンプレートの作成・編集・削除
  - テキスト要素・画像要素の配置
  - プレビュー機能

- **バッチ処理**
  - CSVファイルからの商品情報取り込み
  - 商品画像の一括処理
  - 処理結果のダウンロード

## 技術スタック

- **フレームワーク**: Next.js 14 (App Router)
- **言語**: TypeScript
- **スタイリング**: Tailwind CSS
- **状態管理**: Zustand (ローカルストレージ使用)
- **画像処理**: Canvas API
- **CSV処理**: Papa Parse
- **ZIP圧縮**: JSZip

## インストール

```bash
# プロジェクトをクローン
git clone https://github.com/your-username/image-composer.git
cd image-composer

# 依存パッケージをインストール
npm install

# 開発サーバーを起動
npm run dev
```

## 使用方法

### テンプレート作成

1. ホーム画面から「新規テンプレート」ボタンをクリック
2. テンプレート名や背景色を設定
3. 「テキスト追加」ボタンでテキスト要素を追加
   - 商品名、価格などの動的テキストには `${name}` や `${price}` のようなプレースホルダーを使用
4. 「画像追加」ボタンで装飾画像要素を追加
5. 商品画像の配置位置・サイズを設定
6. 「保存」ボタンでテンプレートを保存

### バッチ処理

1. 「バッチ処理」タブを選択
2. 以下の項目を設定:
   - 使用するテンプレートを選択
   - 商品情報CSVファイルをアップロード
   - 商品画像をアップロード
3. 「処理開始」ボタンをクリック
4. 処理完了後、生成された画像をダウンロード

### CSVフォーマット

以下のようなフォーマットのCSVファイルを用意してください:

```csv
id,name,price,image_file
1,商品名1,1000,product1.png
2,商品名2,2000,product2.png
```

- `id`: 商品ID（出力ファイル名に使用）
- `name`: 商品名（テンプレート内で${name}として参照可能）
- `price`: 価格（テンプレート内で${price}として参照可能）
- `image_file`: 商品画像のファイル名

## プロジェクト構造

```
image-composer/
├── public/
│   └── assets/
│       └── default-backgrounds/  # デフォルト背景画像
├── src/
│   ├── app/
│   │   ├── layout.tsx            # メインレイアウト
│   │   ├── page.tsx              # ホームページ（テンプレート一覧）
│   │   ├── templates/
│   │   │   └── [id]/
│   │   │       └── page.tsx      # テンプレート編集ページ
│   │   └── batch/
│   │       └── page.tsx          # バッチ処理ページ
│   ├── components/               # UIコンポーネント
│   ├── lib/
│   │   ├── types/                # 型定義
│   │   ├── utils/                # ユーティリティ関数
│   │   └── hooks/                # カスタムフック
│   ├── store/                    # Zustandストア
│   └── styles/                   # スタイル定義
```

## 制限事項と注意点

- このアプリケーションはクライアントサイドで動作するため、大量の画像や大きなサイズの画像を処理する場合はブラウザの性能に依存します
- 画像やテンプレートデータはローカルストレージに保存されるため、ブラウザのストレージ容量に制限があります
- 商品画像はファイル選択機能を使ってアップロードする必要があります
- 生成された画像はダウンロードまたはプレビューのみ可能で、サーバーに保存されません

## AWS Amplifyデプロイ方法

1. AWS Amplifyコンソールにログイン
2. 「新しいアプリケーションのデプロイ」>「GitHubからデプロイ」を選択
3. リポジトリとブランチを選択
4. ビルド設定を確認（デフォルト設定でOK）
5. デプロイボタンをクリック

## 開発計画（5時間実装）

このプロジェクトは約5時間での実装を目標としています。以下は推奨開発順序です：

1. **初期セットアップ** (30分)
   - プロジェクト作成
   - 必要なライブラリインストール

2. **データモデルとZustandストア** (40分)
   - 型定義
   - テンプレートストア
   - バッチ処理ストア

3. **レイアウトとナビゲーション** (30分)
   - 基本レイアウト
   - ナビゲーションメニュー

4. **テンプレート編集機能** (60分)
   - テンプレート一覧
   - 編集インターフェース
   - キャンバスプレビュー

5. **画像処理機能** (60分)
   - Canvas APIによる画像合成
   - テキスト配置
   - 画像配置

6. **バッチ処理機能** (60分)
   - CSVアップロード・解析
   - 画像選択機能
   - 処理進捗表示

7. **最終調整とテスト** (40分)
   - エラーハンドリング
   - UI/UX改善
   - 動作テスト

## ライセンス

MITライセンス